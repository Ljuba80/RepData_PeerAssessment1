# Reproducible Research: Peer Assessment 1
# knitr configuration


## Loading and preprocessing the data

```{r}
data<-read.csv("activity.csv");
data1<-subset(data,!is.na(data$step))
data1$date<-as.character(data1$date)
```

## What is mean total number of steps taken per day?
```{r}
tot<-with(data1, tapply(steps, date, sum))
hist(tot,main="Total number of steps")
mean(tot)
median(tot)
```



## What is the average daily activity pattern?

```{r}
avgNSteps<-with(data1, tapply(steps, interval, mean))
plot(unique(data1$interval),avgNSteps,main="Avg daily activity",
     ylab="av # of steps",xlab="interval",col='red',lwd=0)
lines(unique(data1$interval),avgNSteps,col='red');

#gives 206.1698 in 835
avgNSteps[avgNSteps==max(avgNSteps)]
```


## Imputing missing values

```{r}
numOfMissingVal <- sum(is.na(data$steps) | is.na(data$interval))
numOfMissingVal
```


## Are there differences in activity patterns between weekdays and weekends?

```{r}
avgPerInt<-data.frame(steps=avgNSteps,intervals=unique(data$interval))
data$steps[is.na(data$steps)]=avgPerInt$steps
tot1<-with(data, tapply(steps, date, sum))
hist(tot1,main="Total number of steps - imputed missing values")
mean(tot1)
median(tot1)
#adding new variable to data frame
#data<-cbind(data,data.frame(typeOfDay=weekdays(as.Date(data$date))))

data<-cbind(data,data.frame(typeOfDay=""))
levels(data$typeOfDay)<-c("weekday","Weekend")
data$typeOfDay[weekdays(as.Date(data$date))!=as.character("Saturday") & weekdays(as.Date(data$date))!=as.character("Sunday")]=levels(data$typeOfDay)[1]
data$typeOfDay[weekdays(as.Date(data$date))==as.character("Saturday") | weekdays(as.Date(data$date))==as.character("Sunday")]=levels(data$typeOfDay)[2]

ndf1<-subset(data,typeOfDay==levels(data$typeOfDay)[1])
avgNSteps<-with(ndf1, tapply(steps, interval, mean))
plot(unique(ndf1$interval),avgNSteps,main="Avg daily activity-weekday",
     ylab="av # of steps",xlab="interval",type="n")
lines(unique(ndf1$interval),avgNSteps,col="red")

ndf2<-subset(data,typeOfDay==levels(data$typeOfDay)[2])
avgNSteps<-with(ndf2, tapply(steps, interval, mean))
plot(unique(ndf2$interval),avgNSteps,main="Avg daily activity-weekend",
     ylab="av # of steps",xlab="interval",type="n")
lines(unique(ndf2$interval),avgNSteps,col="red")
```

